// playtime.min.js, for SugarCube 2, by Chapel
;setup.playTime={},setup.playTime.options={tryGlobal:!0,storyVar:"playtime",pauseTag:"pausetimer"},State.variables[setup.playTime.options.storyVar]=Date.now(),predisplay["start-playtime"]=function(e){delete predisplay[e],State.variables[setup.playTime.options.storyVar]||(State.variables[setup.playTime.options.storyVar]=Date.now())},prehistory["pause-playtime"]=function(e){tags().includes(setup.playTime.options.pauseTag)&&(State.variables[setup.playTime.options.storyVar]+=time())},setup.playTime.getMS=function(){return Date.now()-State.variables[setup.playTime.options.storyVar]},setup.playTime.getTimeArray=function(e){if(e&&!(e<0)&&"number"==typeof e){var t=[];return t.push(Math.floor(e/1e3)%60),t.push(Math.floor(e/6e4)%60),t.push(Math.floor(e/36e5)%24),t}};var hourNames=["h","hr","hrs","hour","hours"],minNames=["m","min","mins","minute","minutes"],secNames=["s","sec","secs","second","seconds"];setup.playTime.get=function(e){var t=setup.playTime.getMS(),a=setup.playTime.getTimeArray(t);return hourNames.includes(e)?a[2]:minNames.includes(e)?a[1]:secNames.includes(e)?a[0]:t},setup.playTime.formatTime=function(e,t){if(e&&Array.isArray(e)&&!(e.length<3)){var a=e[2]<10?"0"+e[2]:""+e[2],s=e[1]<10?"0"+e[1]:""+e[1],i=e[0]<10?"0"+e[0]:""+e[0];return t?"<b>"+a+":"+s+"</b>:"+i:a+":"+s+":"+i}},setup.playTime.output=function(e){var t=setup.playTime.getMS();return setup.playTime.formatTime(setup.playTime.getTimeArray(t),e)},setup.playTime.options.tryGlobal&&(window.playTime=window.getPlayTime||function(e){return"string"==typeof e?setup.playTime.get(e):setup.playTime.output(e)}),Macro.add("playtime",{handler:function(){var e=this.args.map(function(e){return String(e).trim().toLowerCase()}),t=$(document.createElement("span")),a=e.includesAny(["format","f","fmt","b","bold","true"]),s=setup.playTime.output(a);t.wiki(s).addClass("macro-"+this.name).appendTo(this.output)}});
// end playtime.min.js