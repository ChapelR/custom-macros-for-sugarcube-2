// pronouns.min.js, for SugarCube 2, by Chapel
;!function(){"use strict";if(Template&&Template.add&&"function"==typeof Template.add){var c={name:"gender",showSetting:!0,label:"Gender",desc:"",storyVar:"%%gender",default:"female"},e="#setting-control-"+c.name,p={subjective:["she","he","they"],objective:["her","him","them"],possessive:["hers","his","theirs"],determiner:["her","his","their"],reflexive:["herself","himself","themself"],noun:["woman","man","person"]};c.showSetting&&(Setting.addToggle(c.name,{label:c.label,desc:c.desc&&"string"==typeof c.desc&&c.desc.trim()?c.desc.trim():void 0}),$(document).on(":dialogopen :dialogopened",function(){$("#ui-dialog-body").hasClass("settings")&&$(e).parent("div").empty().append($(document.createElement("button")).append("Configure...").ariaClick(function(){m()}))})),Template.add(["he","she","they","He","She","They"],function(){return f(this.name,h().subjective)}),Template.add(["him","her","them","Him","Her","Them"],function(){return f(this.name,h().objective)}),Template.add(["his","hers","theirs","His","Hers","Theirs"],function(){return f(this.name,h().possessive)}),Template.add(["his_","her_","their","His_","Her_","Their"],function(){return f(this.name,h().determiner)}),Template.add(["himself","herself","themself","Himself","Herself","Themself"],function(){return f(this.name,h().reflexive)}),Template.add(["man","woman","person","Man","Woman","Person"],function(){return f(this.name,h().noun)});var t=/^is$/i,a=/^was$/i,r=/oes$/i,n=/^[dl]ies$/i,s=/ies$/i,i=/sses$/i,o=/hes$/i,l=/s$/i,d=/they/i;Macro.add("pronouns",{skipArgs:!0,handler:function(){m()}}),Macro.add("verb",{handler:function(){var e,t,a=d.test(h().subjective.trim());if(this.args.length<1)return this.error("Please pass at least a singular third person pronoun to this macro.");this.args.includes("plural")&&(a=!0),this.output.append((e=String(this.args[0]),t=this.args[1]?String(this.args[1]):null,!!a?t&&"string"==typeof t?t:g(e):e))}}),setup.gender={pronouns:h,dialog:m,pluralize:g},window.gender=window.gender||setup.gender}else alert("Warning, this version of SugarCube does not include the Template API. Please upgrade to v2.29.0 or higher.");function u(){var e=$(document.createElement("div"));var t,a,r,n,s=Object.keys(p).map(function(e){var t=2;"male"===c.default?t=1:"female"===c.default&&(t=0);var a,r,n,s=State.variables,i=p[e][t];return s[c.storyVar]&&s[c.storyVar][e]&&(i=s[c.storyVar][e]),a=e.toUpperFirst()+": ",r="gender-"+e,n=i,$(document.createElement("label")).append(a).css("display","block").append($(document.createElement("input")).attr({type:"text",name:r}).css({float:"right","margin-left":"0.2em"}).val(n))}),i=(t="Presets: ",a="gender-preset",r=["She/Her","He/Him","They/Them"],n=$(document.createElement("select")).attr("name",a).css("float","right"),r.forEach(function(e,t){console.log(t),$(document.createElement("option")).attr("value",String(t)).append(e).appendTo(n)}),$(document.createElement("label")).css("display","block").append(t,n)).on("change",function(){var r=Number($(this).find("select").val());Number.isNaN(r)||s.forEach(function(e){var t=e.find("input"),a=t.attr("name").split("-")[1];t.val(p[a][r])})}),o=i.find("select");State.variables[c.storyVar]?o.val(""):"male"===c.default?o.val("1"):"female"===c.default?o.val("0"):o.val("2");var l,d=$(document.createElement("button")).wiki("Confirm").addClass("gender-confirm").ariaClick({label:"Confirm pronoun selection."},function(){var r=State.variables;r[c.storyVar]={},s.forEach(function(e){var t=e.find("input"),a=t.attr("name").split("-")[1];r[c.storyVar][a]=t.val().trim().toLowerCase()}),$("#ui-dialog-body").hasClass("reopen")&&UI.settings(),Dialog.close()}),u=(l=[i,"<br>"],s.forEach(function(e){l.push(e),l.push("<br>")}),l.push(d),l);return e.append(u)}function m(){var e,t,a,r;e="Customize Gender",t=u(),r=!(a="custom-gender"),Dialog.isOpen()&&$("#ui-dialog-body").hasClass("settings")&&(r=!0),Dialog.close(),Dialog.setup(e,r?a+" reopen":a),Dialog.append(t),Dialog.open()}function h(){if(State.variables[c.storyVar]&&State.variables[c.storyVar].subjective)return State.variables[c.storyVar];var t=2;"male"===c.default?t=1:"female"===c.default&&(t=0);var a={};return Object.keys(p).forEach(function(e){a[e]=p[e][t]}),a}function f(e,t){return e.first()===e.first().toUpperCase()?t.toUpperFirst():t}function g(e){return e&&"string"==typeof e?(e=e.trim(),t.test(e)?e.replace(t,"are"):a.test(e)?e.replace(a,"were"):r.test(e)?e.replace(r,"o"):n.test(e)?e.replace(s,"ie"):s.test(e)?e.replace(s,"y"):i.test(e)?e.replace(i,"ss"):o.test(e)?e.replace(o,"h"):l.test(e)?e.replace(l,""):e):e}}();
// end pronouns.min.js