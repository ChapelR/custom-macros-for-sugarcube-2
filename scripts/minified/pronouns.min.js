// pronouns.min.js, for SugarCube 2, by Chapel
;!function(){"use strict";if(Template&&Template.add&&"function"==typeof Template.add){var m={name:"gender",showSetting:!0,label:"Gender",desc:"",storyVar:"%%gender",default:"female"},e="#setting-control-"+m.name,c={subjective:["she","he","they"],objective:["her","him","them"],possessive:["hers","his","theirs"],determiner:["her","his","their"],reflexive:["herself","himself","themself"],noun:["woman","man","person"]};m.showSetting&&(Setting.addToggle(m.name,{label:m.label,desc:m.desc&&"string"==typeof m.desc&&m.desc.trim()?m.desc.trim():void 0}),$(document).on(":dialogopen :dialogopened",function(){$("#ui-dialog-body").hasClass("settings")&&$(e).parent("div").empty().append($(document.createElement("button")).append("Configure...").ariaClick(function(){t()}))})),Template.add(["he","she","they","He","She","They"],function(){return n(this.name,a().subjective)}),Template.add(["him","her","them","Him","Her","Them"],function(){return n(this.name,a().objective)}),Template.add(["his","hers","theirs","His","Hers","Theirs"],function(){return n(this.name,a().possessive)}),Template.add(["his_","her_","their","His_","Her_","Their"],function(){return n(this.name,a().determiner)}),Template.add(["himself","herself","themself","Himself","Herself","Themself"],function(){return n(this.name,a().reflexive)}),Template.add(["man","woman","person","Man","Woman","Person"],function(){return n(this.name,a().noun)}),Macro.add("pronouns",{skipArgs:!0,handler:function(){t()}}),setup.gender={pronouns:a,dialog:t},window.gender=window.gender||setup.gender}else alert("Warning, this version of SugarCube does not include the Template API. Please upgrade to v2.29.0 or higher.");function r(){var e=$(document.createElement("div"));var t,a,n,r,i=Object.keys(c).map(function(e){var t=2;"male"===m.default?t=1:"female"===m.default&&(t=0);var a,n,r,i=State.variables,s=c[e][t];return i[m.storyVar]&&i[m.storyVar][e]&&(s=i[m.storyVar][e]),a=e.toUpperFirst()+": ",n="gender-"+e,r=s,$(document.createElement("label")).append(a).css("display","block").append($(document.createElement("input")).attr({type:"text",name:n}).css({float:"right","margin-left":"0.2em"}).val(r))}),s=(t="Presets: ",a="gender-preset",n=["She/Her","He/Him","They/Them"],r=$(document.createElement("select")).attr("name",a).css("float","right"),n.forEach(function(e,t){console.log(t),$(document.createElement("option")).attr("value",String(t)).append(e).appendTo(r)}),$(document.createElement("label")).css("display","block").append(t,r)).on("change",function(){var n=Number($(this).find("select").val());Number.isNaN(n)||i.forEach(function(e){var t=e.find("input"),a=t.attr("name").split("-")[1];t.val(c[a][n])})}),o=s.find("select");State.variables[m.storyVar]?o.val(""):"male"===m.default?o.val("1"):"female"===m.default?o.val("0"):o.val("2");var l,d=$(document.createElement("button")).wiki("Confirm").addClass("gender-confirm").ariaClick({label:"Confirm pronoun selection."},function(){var n=State.variables;n[m.storyVar]={},i.forEach(function(e){var t=e.find("input"),a=t.attr("name").split("-")[1];n[m.storyVar][a]=t.val().trim().toLowerCase()}),$("#ui-dialog-body").hasClass("reopen")&&UI.settings(),Dialog.close()}),u=(l=[s,"<br>"],i.forEach(function(e){l.push(e),l.push("<br>")}),l.push(d),l);return e.append(u)}function t(){var e,t,a,n;e="Customize Gender",t=r(),n=!(a="custom-gender"),Dialog.isOpen()&&$("#ui-dialog-body").hasClass("settings")&&(n=!0),Dialog.close(),Dialog.setup(e,n?a+" reopen":a),Dialog.append(t),Dialog.open()}function a(){if(State.variables[m.storyVar]&&State.variables[m.storyVar][subjective])return State.variables[m.storyVar];var t=2;"male"===m.default?t=1:"female"===m.default&&(t=0);var a={};return Object.keys(c).forEach(function(e){a[e]=c[e][t]}),a}function n(e,t){return e[0]===e[0].toUpperCase()?t.toUpperFirst():t}}();
// end pronouns.min.js