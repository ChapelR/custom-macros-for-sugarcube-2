// speech.min.js, for SugarCube 2, by Chapel
;!function(){"use strict";var c=new Map;function t(t,a){if(State.length)throw new Error("addCharacter() -> must be called before story starts");t&&a?(c.has(t)&&console.error('addCharacter() -> overwriting character "'+t+'"'),c.set(t,a)):console.error("addCharacter() -> invalid arguments")}function a(t,a,e,r){var s=$(document.createElement("div")).addClass(Util.slugify(a)+" say"),n=$(document.createElement("img")).attr("src",r||c.get(a)||"");return n.attr("src")&&n.attr("src").trim()&&s.append(n),s.append($(document.createElement("p")).wiki(a.toUpperFirst())).append($(document.createElement("p")).wiki(e)),t&&(t instanceof $||(t=$(t)),s.appendTo(t)),s}setup.say=a,setup.addCharacter=t,Macro.add("character",{handler:function(){t(this.args[0],this.args[1])}}),$(document).one(":passagestart",function(){var t=Array.from(c.keys());t.push("say"),Macro.add(t,{tags:null,handler:function(){"say"!==this.name?a(this.output,this.name,this.payload[0].contents):a(this.output,this.args[0],this.payload[0].contents,this.args[1])}})})}();
// end speech.min.js